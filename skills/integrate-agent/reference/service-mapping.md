# Veris Service Mapping Reference

Self-contained lookup table mapping real-world services to veris-sandbox mock services.

## How to Use This Reference

Match the agent's dependencies against this catalog using any of these detection signals:

1. **SDK package name** -- check `requirements.txt`, `pyproject.toml`, or `package.json` for known packages
2. **API domain** -- look for hardcoded or configured API hostnames the agent calls
3. **Environment variable name** -- check for env vars the agent reads at startup

Each match tells you which veris service to declare in `veris.yaml` under `services:`.

---

## Master Mapping Table

| Real Service | Veris Service Name | Default Port | DNS Aliases | Detection Signals |
|---|---|---|---|---|
| Salesforce | `crm` | 6200 | `login.salesforce.com`, `test.salesforce.com`, `na1.salesforce.com`, `cs1.salesforce.com`, `mock-salesforce.salesforce.com`, `*.salesforce.com` | SDKs: `simple-salesforce`, `salesforce-bulk`. Env: `SALESFORCE_*`, `SF_*`, `SFDC_*` |
| Google Calendar | `calendar` | 6201 | `www.googleapis.com`, `calendar.google.com`, `calendar-json.googleapis.com`, `googleapis.com`, `oauth2.googleapis.com` | SDKs: `google-api-python-client`, `google-auth`. Env: `GOOGLE_CALENDAR_*`, `GOOGLE_APPLICATION_CREDENTIALS` |
| PostgreSQL | `postgres` | 6202 (HTTP) / 5432 (TCP) | None (TCP protocol) | SDKs: `psycopg2`, `asyncpg`, `sqlalchemy`, `pg`, `@prisma/client`, `knex`. Env: `DATABASE_URL`, `POSTGRES_*` |
| Oracle Fusion Cloud | `oracle` | 6203 | None (plain HTTP, no TLS interception) | Env: `ORACLE_*`, `FUSION_*` |
| Jira | `atlassian/jira` | 6204 | `api.atlassian.com`, `*.atlassian.net`, `*.atlassian.com` | SDKs: `jira`, `atlassian-python-api`, `jira-client`, `@forge/api`. Env: `JIRA_*`, `ATLASSIAN_*` |
| Stripe | `mcp/stripe` | 6205 | `mcp.stripe.com` | SDKs: `stripe` (Python/Node). Env: `STRIPE_SECRET_KEY`, `STRIPE_API_KEY`, `STRIPE_*` |
| Slack | `slack` | 6206 | `slack.com`, `api.slack.com` | SDKs: `slack_sdk`, `slack_bolt`, `@slack/web-api`, `@slack/bolt`. Env: `SLACK_BOT_TOKEN`, `SLACK_SIGNING_SECRET`, `SLACK_*` |
| Wells Fargo / Hogan | `hogan` | 6207 | `api-gateway.wellsfargo.net` | Env: `HOGAN_*`, `WF_*` |
| Confluence | `atlassian/confluence` | 6209 | Shared with Jira (Atlassian gateway) | SDKs: `atlassian-python-api`. Env: `CONFLUENCE_*` |
| Shopify Storefront | `mcp/shopify-storefront` | 6211 | `veris-ai.myshopify.com` | Env: `SHOPIFY_STOREFRONT_*` |
| Shopify Customer | `mcp/shopify-customer` | 6212 | `veris-ai.account.myshopify.com` | Env: `SHOPIFY_CUSTOMER_*` |

---

## Service-Specific Notes

### Salesforce (`crm`)

- OAuth endpoint mocked at `/services/oauth2/token`
- Set `SALESFORCE_DOMAIN=mock-salesforce` in the agent environment
- Use mock consumer key and consumer secret (any non-empty string works)
- REST API paths follow standard Salesforce convention: `/services/data/vXX.0/sobjects/...`

### Google Calendar (`calendar`)

- Requires `GOOGLE_APPLICATION_CREDENTIALS=/certs/mock-service-account.json`
- The mock service account JSON is auto-generated by veris at container startup
- Shares `googleapis.com` DNS aliases -- all Google API traffic routes through this mock

### PostgreSQL (`postgres`)

- No DNS aliases needed (native TCP protocol on port 5432)
- Requires `POSTGRES_PASSWORD` in `services[].config` within `veris.yaml`
- Optional `SCHEMA_PATH` for initial schema setup
- Connection string: `postgresql://postgres:{password}@localhost:5432/SIMULATION_ID`
- The database name is the simulation ID (auto-created per run)

### Oracle Fusion Cloud (`oracle`)

- No DNS interception -- plain HTTP only
- Agent must be configured to call `localhost:6203` directly, typically via an env var
- Covers Oracle Fusion Cloud REST APIs (ERP, HCM, SCM)

### Jira (`atlassian/jira`)

- Shares DNS aliases with Confluence via the Atlassian gateway pattern
- Agent typically uses `{site}.atlassian.net` domain
- SQLite-backed deterministic CRUD (no LLM in request path)

### Confluence (`atlassian/confluence`)

- Shares the Atlassian gateway with Jira (same DNS aliases)
- Both can be declared simultaneously in `veris.yaml`

### Stripe (`mcp/stripe`)

- MCP server, not a REST API
- Agent must use the MCP protocol (stdio or SSE transport)
- Exposes 28 tools covering customers, payments, subscriptions, invoices, etc.

### Shopify Storefront / Customer (`mcp/shopify-storefront`, `mcp/shopify-customer`)

- Both are MCP servers
- Storefront covers product catalog, collections, search
- Customer covers account management, orders, addresses

### Slack (`slack`)

- Mock bot token format: `xoxb-mock-token-for-veris-simulation`
- Covers Web API methods (chat.postMessage, conversations.list, users.list, etc.)

### Wells Fargo / Hogan (`hogan`)

- Banking and customer management APIs
- Covers Hogan core banking system interfaces

---

## SDK Detection Patterns

### Python packages

| Package | Veris Service |
|---|---|
| `simple-salesforce` | `crm` |
| `salesforce-bulk` | `crm` |
| `google-api-python-client` (with calendar scope) | `calendar` |
| `google-auth`, `google-auth-oauthlib` | `calendar` |
| `psycopg2`, `psycopg2-binary` | `postgres` |
| `asyncpg` | `postgres` |
| `sqlalchemy` (with `postgresql://` URL) | `postgres` |
| `stripe` | `mcp/stripe` |
| `jira` | `atlassian/jira` |
| `atlassian-python-api` | `atlassian/jira` or `atlassian/confluence` |
| `slack_sdk` | `slack` |
| `slack_bolt` | `slack` |

### Node packages

| Package | Veris Service |
|---|---|
| `pg` | `postgres` |
| `@prisma/client` (with `postgresql://` URL) | `postgres` |
| `knex` (with postgres driver) | `postgres` |
| `stripe` | `mcp/stripe` |
| `jira-client` | `atlassian/jira` |
| `@forge/api` | `atlassian/jira` |
| `@slack/web-api` | `slack` |
| `@slack/bolt` | `slack` |

---

## LLM Provider Interception (Automatic)

The veris LLM proxy automatically intercepts calls to 30+ LLM API domains. No `veris.yaml` service entry is needed. The agent's API keys (`OPENAI_API_KEY`, `ANTHROPIC_API_KEY`, etc.) are passed through to the real API via the proxy.

Intercepted domains include:

| Provider | Domains |
|---|---|
| OpenAI | `api.openai.com`, `*.openai.azure.com` |
| Anthropic | `api.anthropic.com` |
| Google AI | `generativelanguage.googleapis.com`, `aiplatform.googleapis.com` |
| Mistral | `api.mistral.ai` |
| Groq | `api.groq.com` |
| DeepSeek | `api.deepseek.com` |
| Together | `api.together.xyz` |
| Fireworks | `api.fireworks.ai` |
| Cohere | `api.cohere.ai` |

---

## Port Registry

### Infrastructure Ports

| Service | Port | Purpose |
|---|---|---|
| Engine | 6100 | Simulation orchestrator |
| Persona | 6101 | Multi-modal agent simulator |
| LLM Proxy | 6102 (HTTP) / 443 (TLS via nginx) | Transparent LLM call interception |

### Mock Service Ports

| Service | Port |
|---|---|
| `crm` | 6200 |
| `calendar` | 6201 |
| `postgres` | 6202 (HTTP) / 5432 (native TCP) |
| `oracle` | 6203 |
| `atlassian/jira` | 6204 |
| `mcp/stripe` | 6205 |
| `slack` | 6206 |
| `hogan` | 6207 |
| `atlassian/confluence` | 6209 |
| `mcp/shopify-storefront` | 6211 |
| `mcp/shopify-customer` | 6212 |

### Agent Port Guidelines

Use any port not in the 6100-6299 range. Common choices: `8080`, `8008`, `3000`.
